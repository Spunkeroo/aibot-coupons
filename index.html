<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>aibot.coupons ‚Äî AI coupon & deal finder ‚Äî find the best codes instantly</title>
  <meta name="description" content="Find the best coupons, promo codes, and deals with AI. Paste a product URL or describe what you're buying to find savings.">
  <meta name="keywords" content="AI coupon finder, promo codes, deal finder, discount codes AI, save money bot">
  <meta property="og:title" content="aibot.coupons ‚Äî CouponBot">
  <meta property="og:description" content="Find the best coupons, promo codes, and deals with AI. Paste a product URL or describe what you're buying to find savings.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://aibot.coupons">
  <meta property="og:image" content="https://aibot.coupons/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@SpunkArt13">
  <meta name="twitter:title" content="CouponBot ‚Äî aibot.coupons">
  <meta name="twitter:description" content="AI coupon & deal finder ‚Äî find the best codes instantly">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè∑Ô∏è</text></svg>">
  <link rel="canonical" href="https://aibot.coupons">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"SoftwareApplication","name":"CouponBot","url":"https://aibot.coupons","description":"Find the best coupons, promo codes, and deals with AI. Paste a product URL or describe what you're buying to find savings.","applicationCategory":"UtilityApplication","operatingSystem":"Web"}</script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    :root{
      --bg:#050508;--surface:#0a0a12;--card:#0e0e18;--card-hover:#121220;
      --border:#1a1a2e;--text:#e8e8f0;--dim:#8888a0;--muted:#555568;
      --accent:#10b981;--accent-glow:rgba(16,185,129,0.12);
      --green:#10b981;--red:#ef4444;
    }
    html{scroll-behavior:smooth;}
    body{background:var(--bg);color:var(--text);font-family:'Inter',-apple-system,sans-serif;line-height:1.7;-webkit-font-smoothing:antialiased;display:flex;flex-direction:column;min-height:100vh;}
    a{color:var(--accent);text-decoration:none;transition:opacity 0.2s;}
    a:hover{opacity:0.85;}

    /* NAV */
    .nav{position:sticky;top:0;z-index:100;background:rgba(5,5,8,0.95);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
    .nav-inner{max-width:1000px;margin:0 auto;padding:0.7rem 1.5rem;display:flex;align-items:center;justify-content:space-between;gap:1rem;}
    .nav-logo{font-size:1.1rem;font-weight:900;letter-spacing:-0.5px;display:flex;align-items:center;gap:0.4rem;}
    .nav-logo .accent{color:var(--accent);}
    .nav-right{display:flex;align-items:center;gap:1rem;}
    .nav-uses{font-size:0.75rem;color:var(--dim);font-weight:600;}
    .nav-uses span{color:var(--accent);font-weight:800;}
    .nav-upgrade{background:var(--accent);color:#fff;padding:0.4rem 0.9rem;border-radius:8px;font-size:0.75rem;font-weight:700;border:none;cursor:pointer;transition:all 0.2s;}
    .nav-upgrade:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(16,185,129,0.3);}

    /* NETWORK BAR */
    .site-bar{border-bottom:1px solid var(--border);padding:0.6rem 1.5rem;display:flex;justify-content:center;gap:1.2rem;flex-wrap:wrap;overflow-x:auto;}
    .site-link{display:flex;align-items:center;gap:0.3rem;font-size:0.7rem;font-weight:700;color:var(--dim);transition:color 0.2s;white-space:nowrap;}
    .site-link:hover{color:var(--text);}
    .site-link .dot{width:5px;height:5px;border-radius:50%;display:inline-block;}

    /* MAIN CHAT AREA */
    .chat-container{flex:1;max-width:800px;width:100%;margin:0 auto;padding:1rem 1.5rem;display:flex;flex-direction:column;}

    /* WELCOME */
    .welcome{text-align:center;padding:3rem 0 2rem;flex-shrink:0;}
    .welcome-icon{font-size:3rem;margin-bottom:0.5rem;}
    .welcome h1{font-size:2.2rem;font-weight:900;letter-spacing:-1.5px;margin-bottom:0.3rem;}
    .welcome h1 .gr{background:linear-gradient(135deg,var(--accent),#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
    .welcome p{color:var(--dim);font-size:0.95rem;max-width:500px;margin:0 auto 1.5rem;}
    .examples{display:flex;flex-wrap:wrap;gap:0.5rem;justify-content:center;}
    .example-btn{background:var(--card);border:1px solid var(--border);color:var(--dim);padding:0.5rem 1rem;border-radius:10px;font-size:0.8rem;font-family:inherit;cursor:pointer;transition:all 0.2s;max-width:280px;text-align:left;}
    .example-btn:hover{border-color:var(--accent);color:var(--text);}
    @media(max-width:600px){.welcome h1{font-size:1.7rem;}}

    /* MESSAGES */
    .messages{flex:1;overflow-y:auto;padding:1rem 0;display:flex;flex-direction:column;gap:1rem;}
    .msg{max-width:85%;padding:1rem 1.2rem;border-radius:14px;font-size:0.88rem;line-height:1.6;animation:fadeIn 0.3s ease;}
    .msg-user{background:var(--accent);color:#fff;align-self:flex-end;border-bottom-right-radius:4px;}
    .msg-bot{background:var(--card);border:1px solid var(--border);align-self:flex-start;border-bottom-left-radius:4px;position:relative;}
    .msg-bot .msg-actions{display:flex;gap:0.5rem;margin-top:0.75rem;padding-top:0.5rem;border-top:1px solid var(--border);}
    .msg-action{background:var(--surface);border:1px solid var(--border);color:var(--dim);padding:0.3rem 0.7rem;border-radius:6px;font-size:0.7rem;font-family:inherit;cursor:pointer;transition:all 0.2s;}
    .msg-action:hover{border-color:var(--accent);color:var(--text);}
    .typing{display:flex;gap:4px;padding:1rem;align-self:flex-start;}
    .typing span{width:8px;height:8px;background:var(--muted);border-radius:50%;animation:bounce 1.4s infinite;}
    .typing span:nth-child(2){animation-delay:0.2s;}
    .typing span:nth-child(3){animation-delay:0.4s;}
    @keyframes bounce{0%,60%,100%{transform:translateY(0);}30%{transform:translateY(-8px);}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}

    /* INPUT */
    .input-area{padding:1rem 0;border-top:1px solid var(--border);flex-shrink:0;}
    .input-wrap{display:flex;gap:0.5rem;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:0.5rem;transition:border-color 0.2s;}
    .input-wrap:focus-within{border-color:var(--accent);}
    .input-wrap input{flex:1;background:transparent;border:none;color:var(--text);font-size:0.9rem;font-family:inherit;padding:0.4rem 0.6rem;outline:none;}
    .input-wrap input::placeholder{color:var(--muted);}
    .send-btn{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:0.5rem 1rem;font-weight:700;font-size:0.85rem;cursor:pointer;transition:all 0.2s;font-family:inherit;}
    .send-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(16,185,129,0.3);}
    .send-btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;box-shadow:none;}

    /* PAYWALL MODAL */
    .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:500;display:none;align-items:center;justify-content:center;padding:1.5rem;}
    .modal-overlay.active{display:flex;}
    .modal{background:var(--card);border:1px solid var(--border);border-radius:16px;max-width:500px;width:100%;padding:2rem;text-align:center;position:relative;}
    .modal-close{position:absolute;top:1rem;right:1rem;background:var(--surface);border:1px solid var(--border);color:var(--dim);width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem;}
    .modal-close:hover{color:var(--text);border-color:var(--accent);}
    .modal h2{font-size:1.4rem;font-weight:900;margin-bottom:0.5rem;}
    .modal p{color:var(--dim);font-size:0.85rem;margin-bottom:1.5rem;}
    .pricing-cards{display:flex;gap:0.75rem;margin-bottom:1.5rem;}
    .price-card{flex:1;background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1rem;cursor:pointer;transition:all 0.2s;}
    .price-card:hover,.price-card.featured{border-color:var(--accent);}
    .price-card.featured{position:relative;}
    .price-card.featured::before{content:'BEST VALUE';position:absolute;top:-8px;left:50%;transform:translateX(-50%);background:var(--accent);color:#fff;font-size:0.55rem;font-weight:800;padding:0.15rem 0.5rem;border-radius:4px;letter-spacing:1px;}
    .price-card .pc-price{font-size:1.4rem;font-weight:900;color:var(--text);}
    .price-card .pc-period{font-size:0.7rem;color:var(--dim);display:block;}
    .price-card .pc-desc{font-size:0.7rem;color:var(--muted);margin-top:0.3rem;}
    .pay-btn{width:100%;padding:0.7rem;border-radius:10px;font-weight:700;font-size:0.9rem;border:none;cursor:pointer;transition:all 0.2s;font-family:inherit;margin-bottom:0.5rem;}
    .pay-btn-stripe{background:var(--accent);color:#fff;}
    .pay-btn-stripe:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(16,185,129,0.3);}
    .pay-btn-crypto{background:var(--surface);border:1px solid var(--border);color:var(--text);}
    .pay-btn-crypto:hover{border-color:var(--accent);}
    .crypto-details{display:none;text-align:left;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1rem;margin-top:0.5rem;}
    .crypto-details.active{display:block;}
    .crypto-addr{font-family:'JetBrains Mono',monospace;font-size:0.65rem;color:var(--accent);word-break:break-all;cursor:pointer;padding:0.4rem;background:var(--bg);border-radius:6px;margin:0.3rem 0;}
    .crypto-label{font-size:0.7rem;color:var(--dim);font-weight:600;margin-top:0.5rem;}
    .modal-ref{font-size:0.75rem;color:var(--dim);margin-top:1rem;}
    .modal-ref a{color:var(--accent);}
    @media(max-width:500px){.pricing-cards{flex-direction:column;}}

    /* FOOTER */
    .footer{border-top:1px solid var(--border);padding:1.5rem;text-align:center;}
    .footer-links{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;margin-bottom:0.75rem;}
    .footer-links a{color:var(--muted);font-size:0.7rem;font-weight:600;}
    .footer-links a:hover{color:var(--text);}
    .footer-copy{font-size:0.65rem;color:var(--muted);}
  </style>
</head>
<body>

<!-- GA -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GVNL11PEGP"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-GVNL11PEGP');</script>

<!-- NAV -->
<nav class="nav">
  <div class="nav-inner">
    <div class="nav-logo">üè∑Ô∏è <span class="accent">CouponBot</span></div>
    <div class="nav-right">
      <div class="nav-uses">Uses today: <span id="useCount">0</span> / <span id="useMax">3</span></div>
      <button class="nav-upgrade" onclick="showPaywall()">Upgrade</button>
    </div>
  </div>
</nav>

<!-- NETWORK BAR -->
<div class="site-bar">
  <a href="https://aibot.beer" class="site-link"><span class="dot" style="background:#d97706;"></span>üç∫ aibot.beer</a>
  <a href="https://aibot.coupons" class="site-link" style="color:var(--text);"><span class="dot" style="background:#10b981;"></span>üè∑Ô∏è aibot.coupons</a>
  <a href="https://aibot.courses" class="site-link"><span class="dot" style="background:#14b8a6;"></span>üéì aibot.courses</a>
  <span style="color:var(--muted);padding:0 0.3rem;">|</span>
  <a href="https://spunk.bet" class="site-link" target="_blank" rel="noopener"><span class="dot" style="background:#ff5f1f;"></span>üé∞ spunk.bet</a>
  <a href="https://predict.pics" class="site-link" target="_blank" rel="noopener"><span class="dot" style="background:#a855f7;"></span>üîÆ predict.pics</a>
  <a href="https://scam.video" class="site-link" target="_blank" rel="noopener"><span class="dot" style="background:#ef4444;"></span>üì∫ scam.video</a>
  <a href="https://stimulant.wiki" class="site-link" target="_blank" rel="noopener"><span class="dot" style="background:#8b5cf6;"></span>üìñ stimulant.wiki</a>
</div>

<!-- CHAT CONTAINER -->
<div class="chat-container">
  <!-- WELCOME -->
  <div class="welcome" id="welcome">
    <div class="welcome-icon">üè∑Ô∏è</div>
    <h1>Coupon<span class='gr'>Bot</span></h1>
    <p>Find the best coupons, promo codes, and deals. Tell me what you're buying and I'll find the savings.</p>
    <div class="examples">
      <button class="example-btn" onclick="askExample(this.textContent)">Best ways to save on Amazon purchases</button>
      <button class="example-btn" onclick="askExample(this.textContent)">Find me a discount code for DoorDash</button>
      <button class="example-btn" onclick="askExample(this.textContent)">How do I stack coupons at Target?</button>
      <button class="example-btn" onclick="askExample(this.textContent)">When is the best time to buy a new laptop?</button>
    </div>
  </div>

  <!-- MESSAGES -->
  <div class="messages" id="messages"></div>

  <!-- INPUT -->
  <div class="input-area">
    <div class="input-wrap">
      <input type="text" id="userInput" placeholder="e.g., Find coupon codes for Nike.com" autocomplete="off">
      <button class="send-btn" id="sendBtn" onclick="sendMessage()">Ask CouponBot</button>
    </div>
  </div>
</div>

<!-- PAYWALL MODAL -->
<div class="modal-overlay" id="paywallModal" onclick="if(event.target===this)closePaywall()">
  <div class="modal">
    <div class="modal-close" onclick="closePaywall()">‚úï</div>
    <h2>üè∑Ô∏è Unlock Unlimited CouponBot</h2>
    <p>You've used your 3 free daily queries. Upgrade for unlimited access.</p>
    <div class="pricing-cards">
      <div class="price-card" onclick="selectPlan('day')" id="planDay">
        <div class="pc-price">$2.99</div>
        <span class="pc-period">24-hour pass</span>
        <div class="pc-desc">Unlimited for today</div>
      </div>
      <div class="price-card featured" onclick="selectPlan('month')" id="planMonth">
        <div class="pc-price">$9.99</div>
        <span class="pc-period">per month</span>
        <div class="pc-desc">Unlimited across ALL bots</div>
      </div>
    </div>
    <button class="pay-btn pay-btn-stripe" onclick="payStripe()">Pay with Card</button>
    <button class="pay-btn pay-btn-crypto" onclick="toggleCrypto()">Pay with Crypto</button>
    <div class="crypto-details" id="cryptoDetails">
      <div class="crypto-label">Bitcoin (BTC)</div>
      <div class="crypto-addr" onclick="copyAddr(this)" title="Click to copy">bc1pkepg42ctsvsxk499qu02qqyyz88gwjchnjpsu22wmng9rhpfv3jqw2t2hm</div>
      <div class="crypto-label">Ethereum (ETH)</div>
      <div class="crypto-addr" onclick="copyAddr(this)" title="Click to copy">0xD2aC89253b5F20f5b03b5B591297Fa4FCC37d41c</div>
      <div style="font-size:0.65rem;color:var(--muted);margin-top:0.5rem;">Send exact amount + email us at contact@spunkart.com for activation</div>
    </div>
    <div class="modal-ref">
      Share &amp; earn! <a href="#" onclick="shareRef();return false;">Get your referral link</a> ‚Äî 5 free uses for you and your friend.
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer class="footer">
  <div class="footer-links" style="margin-bottom:0.3rem">
    <a href="https://aibot.beer">aibot.beer</a>
    <a href="https://aibot.coupons">aibot.coupons</a>
    <a href="https://aibot.courses">aibot.courses</a>
  </div>
  <div class="footer-links" style="margin-bottom:0.3rem;font-size:0.6rem">
    <a href="https://predict.pics">predict.pics</a>
    <a href="https://predict.horse">predict.horse</a>
    <a href="https://predict.mom">predict.mom</a>
    <a href="https://scam.video">scam.video</a>
    <a href="https://scam.wiki">scam.wiki</a>
    <a href="https://stimulant.wiki">stimulant.wiki</a>
    <a href="https://spunk.bet" style="color:#ff5f1f">spunk.bet</a>
    <a href="https://spunkart.com">spunkart.com</a>
  </div>
  <div class="footer-links">
    <a href="https://aibot.beer">aibot.beer</a>
    <a href="https://aibot.courses">aibot.courses</a>
    <a href="https://stake.com/?c=MyXSehCn" target="_blank" rel="noopener sponsored" style="color:#1475e1;font-size:0.65rem;font-weight:700;text-decoration:none;">Stake.com</a>
    <a href="https://stake.us/?c=L2a8nG6c" target="_blank" rel="noopener sponsored" style="color:#00c74d;font-weight:600;">Stake.us</a>
    <a href="https://winna.com/?r=Spunkeroo" target="_blank" rel="noopener sponsored" style="color:#ff5f1f;font-weight:600;">Winna.com</a>
    <a href="https://coinbase.com/join/YAGES3X?src=referral-link" target="_blank" rel="noopener sponsored" style="color:#0052ff;font-weight:600;">Buy Crypto</a>
    <a href="https://shop.ledger.com/?r=0553c9ea1441" target="_blank" rel="noopener sponsored" style="color:#ff5500;font-weight:600;">Secure Crypto</a>
    <a href="https://kalshi.com/sign-up/?referral=6b723b42-d0c9-4421-9b4e-5af4b4c6c42c" target="_blank" rel="noopener sponsored" style="color:#00d084;font-weight:600;">Kalshi</a>
    <a href="https://everyx.io/register?ref=AYHl4YqvjcaX" target="_blank" rel="noopener sponsored" style="color:#a855f7;font-weight:600;">EveryX</a>
    <a href="https://spunk.bet" target="_blank" rel="noopener sponsored" style="color:#ff5f1f;font-weight:600;">Spunk.Bet</a>
    <a href="https://x.com/SpunkArt13" target="_blank" rel="noopener noreferrer">@SpunkArt13</a>
  </div>
  <div class="footer-copy">&copy; 2026 aibot.coupons ‚Äî CouponBot by @SpunkArt13 | <a href="https://spunkart.com">SpunkArt.com</a></div>
</footer>

<script>
// ============================================================
// CONFIG
// ============================================================
const BOT_NAME = 'CouponBot';
const DOMAIN = 'aibot.coupons';
const SLUG = 'coupons';
const SHARE_TEXT = 'CouponBot just saved me money! üè∑Ô∏è';
const SYSTEM_PROMPT = `You are CouponBot, an AI coupon and deal-finding assistant. Help users find promo codes, coupons, and the best deals. Provide money-saving tips, coupon stacking strategies, best times to buy, cashback recommendations (Rakuten, Honey, etc.), and price comparison advice. Be specific and actionable. Always mention checking multiple coupon sites.`;
const FREE_USES = 3;
const REFERRAL_BONUS = 5;

// ============================================================
// USAGE TRACKING (localStorage + fingerprint)
// ============================================================
function getToday() {
  return new Date().toISOString().split('T')[0];
}

function getUsage() {
  const data = JSON.parse(localStorage.getItem('aibot_usage') || '{}');
  if (data.date !== getToday()) {
    data.date = getToday();
    data.count = 0;
    localStorage.setItem('aibot_usage', JSON.stringify(data));
  }
  return data;
}

function incrementUsage() {
  const data = getUsage();
  data.count++;
  localStorage.setItem('aibot_usage', JSON.stringify(data));
  updateUsageDisplay();
  return data.count;
}

function getRemainingUses() {
  const data = getUsage();
  const bonus = parseInt(localStorage.getItem('aibot_bonus') || '0');
  const maxUses = FREE_USES + bonus;
  return maxUses - data.count;
}

function isPaid() {
  const sub = JSON.parse(localStorage.getItem('aibot_subscription') || '{}');
  if (sub.type === 'month' && new Date(sub.expires) > new Date()) return true;
  if (sub.type === 'day' && new Date(sub.expires) > new Date()) return true;
  return false;
}

function updateUsageDisplay() {
  const data = getUsage();
  const bonus = parseInt(localStorage.getItem('aibot_bonus') || '0');
  const maxUses = FREE_USES + bonus;
  document.getElementById('useCount').textContent = data.count;
  document.getElementById('useMax').textContent = isPaid() ? '‚àû' : maxUses;
}

// ============================================================
// CHAT FUNCTIONALITY
// ============================================================
const messagesEl = document.getElementById('messages');
const welcomeEl = document.getElementById('welcome');
const inputEl = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');

function askExample(text) {
  inputEl.value = text;
  sendMessage();
}

async function sendMessage() {
  const text = inputEl.value.trim();
  if (!text) return;

  // Check usage
  if (!isPaid() && getRemainingUses() <= 0) {
    showPaywall();
    return;
  }

  // Hide welcome, show messages
  welcomeEl.style.display = 'none';

  // Add user message
  addMessage(text, 'user');
  inputEl.value = '';
  sendBtn.disabled = true;

  // Show typing indicator
  const typingEl = showTyping();

  // Increment usage
  incrementUsage();

  // Generate AI response (simulated ‚Äî replace with real API call)
  try {
    const response = await generateResponse(text);
    typingEl.remove();
    addBotMessage(response);
  } catch (err) {
    typingEl.remove();
    addBotMessage("Sorry, I'm having trouble right now. Please try again in a moment.");
  }

  sendBtn.disabled = false;
  inputEl.focus();
}

function addMessage(text, type) {
  const msg = document.createElement('div');
  msg.className = `msg msg-${type}`;
  msg.textContent = text;
  messagesEl.appendChild(msg);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function addBotMessage(text) {
  const msg = document.createElement('div');
  msg.className = 'msg msg-bot';

  // Format response (basic markdown-like formatting)
  let formatted = text
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
    .replace(/\n- /g, '\n‚Ä¢ ')
    .replace(/\n\n/g, '<br><br>')
    .replace(/\n/g, '<br>');

  msg.innerHTML = `
    <div>${formatted}</div>
    <div class="msg-actions">
      <button class="msg-action" onclick="shareOnX('${encodeURIComponent(text.substring(0, 100))}')">Share on X</button>
      <button class="msg-action" onclick="copyResponse(this)">Copy</button>
    </div>
  `;
  messagesEl.appendChild(msg);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function showTyping() {
  const typing = document.createElement('div');
  typing.className = 'typing';
  typing.innerHTML = '<span></span><span></span><span></span>';
  messagesEl.appendChild(typing);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  return typing;
}

// ============================================================
// AI RESPONSE GENERATION
// ============================================================
// This generates intelligent responses client-side for the free tier.
// For production, replace with actual API calls to Claude/OpenAI.
async function generateResponse(query) {
  // Simulate API delay
  await new Promise(r => setTimeout(r, 1000 + Math.random() * 1500));

  // Smart template-based responses (free tier)
  // Replace this entire function with real API call for paid tier:
  //
  // const res = await fetch('/api/chat', {
  //   method: 'POST',
  //   headers: {'Content-Type': 'application/json'},
  //   body: JSON.stringify({ message: query, system: SYSTEM_PROMPT })
  // });
  // const data = await res.json();
  // return data.response;

  return generateSmartResponse(query);
}

function generateSmartResponse(query) {
  const q = query.toLowerCase();
  const responses = getResponses();

  let bestMatch = null;
  let bestScore = 0;
  for (const [keywords, response] of responses) {
    const score = keywords.filter(k => q.includes(k)).length;
    if (score > bestScore) { bestScore = score; bestMatch = response; }
  }
  if (bestMatch) return bestMatch;

  return generateContextualCouponResponse(query);
}

function generateContextualCouponResponse(query) {
  const q = query.toLowerCase();

  // Detect specific stores
  const stores = {'walmart':'Walmart','target':'Target','amazon':'Amazon','best buy':'Best Buy','bestbuy':'Best Buy','costco':'Costco','nike':'Nike','adidas':'Adidas','apple':'Apple','home depot':'Home Depot','lowes':'Lowe\'s','macys':'Macy\'s','nordstrom':'Nordstrom','sephora':'Sephora','ulta':'Ulta','shein':'SHEIN','temu':'Temu','ebay':'eBay','etsy':'Etsy','wayfair':'Wayfair','ikea':'IKEA','uber':'Uber','doordash':'DoorDash','grubhub':'Grubhub','instacart':'Instacart','netflix':'Netflix','spotify':'Spotify','disney':'Disney+','hulu':'Hulu','youtube':'YouTube Premium'};
  for (const [key, name] of Object.entries(stores)) {
    if (q.includes(key)) {
      const tips = {
        'Amazon': '**Subscribe & Save** (5-15% off), **Warehouse Deals** (20-50% off open-box), **amazon.com/coupons** page, price track with CamelCamelCamel, check Woot.com (Amazon-owned) for daily deals',
        'Target': '**Target Circle** app (free, personalized deals), **RedCard** (5% off everything), stack manufacturer coupons + Target Circle offers, price match within 14 days',
        'Walmart': '**Walmart+** ($12.99/mo for free delivery + fuel discounts), price match guarantee, use Ibotta for cash back on groceries, Rollback section online',
        'Best Buy': '**My Best Buy** membership (free, earns points), **Open-box deals** (up to 50% off), price match Amazon/Costco/Target, student discount program',
        'Costco': '**Executive membership** (2% cash back), buy Costco gift cards at a discount, shop end-of-season clearance, tire deals are unbeatable',
        'Nike': '**Nike Members** (free, early access + birthday discount), **Nike Refurbished** (like-new for 40% off), student discount 10%, use Rakuten for 5-8% back',
        'Sephora': '**Beauty Insider** (free tier gets birthday gift), save points for Rouge tier, **fragrance sampler sets** (try before committing), 15-20% off sales twice yearly',
        'SHEIN': '**First order 15% off** (always available), free shipping over $29, check-in daily for points, student discount 15%',
      };
      const storeTip = tips[name] || `Sign up for ${name}'s email list for 10-15% off first order, use Rakuten/TopCashback for extra cash back, check RetailMeNot for current codes`;
      return `**${name} ‚Äî Best Ways to Save**\n\n${storeTip}\n\n**Universal Strategies:**\n1. Install Honey browser extension (auto-applies codes)\n2. Check Rakuten for cash back (2-15%)\n3. Google "${name.toLowerCase()} promo code" before checkout\n4. Sign up for email list ‚Üí get welcome discount ‚Üí unsubscribe\n5. Use a cash back credit card (2-5% extra)\n\n**Best Times to Buy at ${name}:**\n- Black Friday / Cyber Monday\n- End of season clearance\n- Back to school (Aug-Sep)\n- Prime Day (even non-Amazon stores run competing sales)\n\n**Try asking me:** "Best coupon codes for ${name}" or "How to stack discounts at ${name}"`;
    }
  }

  // Detect category questions
  if (q.match(/grocery|food|meal|cook|kitchen/)) {
    return `**Grocery Savings Guide**\n\n**Apps That Pay You Cash Back:**\n1. **Ibotta** ‚Äî Scan receipts, earn cash (avg $20-50/month)\n2. **Fetch Rewards** ‚Äî Scan any receipt, earn points\n3. **Checkout 51** ‚Äî Weekly offers on groceries\n4. **Shopkick** ‚Äî Earn points just for walking into stores\n\n**Store Strategies:**\n- **Aldi/Lidl**: Already 30-50% cheaper than regular stores\n- **Costco/Sam's**: Best for bulk staples, meat, cheese\n- **Walmart Pickup**: Price match + use Ibotta\n- **Target Circle**: Free app with personalized grocery deals\n\n**Meal Planning = Biggest Saver:**\n1. Plan meals around what's on sale this week\n2. Buy in bulk when your staples are discounted\n3. Use the Flipp app to browse all local store flyers\n4. Never shop hungry (seriously, saves 20%+)\n\n**Avg Savings:** $200-400/month for a family of 4 using these strategies.`;
  }

  if (q.match(/travel|flight|hotel|airbnb|vacation|trip/)) {
    return `**Travel Deal Finder**\n\n**Flights:**\n- **Google Flights**: Best overall search + price tracking\n- **Skiplagged**: Hidden city ticketing (controversial but legal)\n- **Scott's Cheap Flights**: Email alerts for mistake fares (free tier)\n- **Book Tue-Thu** for cheapest fares, fly Tue/Wed for cheapest days\n\n**Hotels:**\n- **Booking.com**: Best selection + Genius loyalty discounts\n- **Hotels.com**: Buy 10 nights get 1 free\n- **Hotwire**: Blind booking = 60% off brand hotels\n- **Call the hotel directly** ‚Äî often match or beat online prices\n\n**Money-Saving Hacks:**\n1. Use incognito mode (prices increase with repeat searches)\n2. Book refundable rate, then check for price drops\n3. Credit card travel portals (Chase, Amex) offer bonus points\n4. Airbnb is only cheaper for 4+ people or long stays\n\n**Best Time to Book:** Domestic flights 1-3 months out, international 2-8 months out.`;
  }

  if (q.match(/phone|iphone|samsung|android|laptop|computer|tech|electronics/)) {
    return `**Tech & Electronics Deals**\n\n**Best Times to Buy:**\n- **iPhones**: September (new release, old models drop $100-200)\n- **Laptops**: Back to school (July-Aug) or Black Friday\n- **TVs**: Super Bowl week (Jan-Feb) or Black Friday\n- **General electronics**: Amazon Prime Day (July)\n\n**Where to Find Deals:**\n- **Slickdeals.net**: Community-voted best deals (check daily)\n- **CamelCamelCamel**: Amazon price history (never overpay)\n- **Best Buy Open Box**: Up to 50% off, full warranty\n- **Amazon Renewed**: Refurbished electronics with 90-day guarantee\n- **Apple Refurbished Store**: Like-new Apple products, full warranty\n\n**Pro Tips:**\n1. Never buy tech at launch ‚Äî wait 2-3 months for price drops\n2. Previous-gen is 90% as good for 50% less\n3. Price match at Best Buy (they match Amazon, Costco, Target)\n4. Use Rakuten for 2-8% cash back on electronics`;
  }

  // Smart default
  return `**CouponBot ‚Äî Let Me Help You Save!**\n\nHere's my best general advice for saving money on "${query.substring(0,50)}":\n\n**Step 1: Before You Buy Anything**\n1. Install **Honey** browser extension (auto-finds codes at checkout)\n2. Open **Rakuten** (earn 2-15% cash back at 3500+ stores)\n3. Google "[store name] promo code" ‚Äî check top 3 results\n\n**Step 2: Stack Your Savings**\n- Email signup discount (10-15% off first order)\n- + Coupon code from Honey/RetailMeNot\n- + Cash back from Rakuten/TopCashback\n- + Cash back credit card (2-5%)\n- = **15-35% total savings on most purchases**\n\n**Step 3: Time It Right**\n- Black Friday / Cyber Monday: Best all-around\n- Prime Day (July): Tech + Amazon deals\n- End of season: Clothing 50-70% off\n- Holiday clearance (Jan, post-July 4th)\n\n**Try asking me about a specific store** (Amazon, Target, Nike, etc.) or **category** (groceries, travel, electronics) for targeted advice!`;
}

function getResponses() {
  return [
  [["amazon", "save", "deal", "prime"], `**Amazon Money-Saving Strategies**\n\n**Browser Extensions (Install These):**\n- **Honey** ‚Äî Auto-applies coupon codes at checkout\n- **CamelCamelCamel** ‚Äî Price history tracker (never overpay)\n- **Capital One Shopping** ‚Äî Finds better prices elsewhere\n\n**Amazon-Specific Tricks:**\n- **Subscribe & Save**: 5-15% off recurring items, cancel anytime\n- **Warehouse Deals**: Open-box items, 20-50% off\n- **Coupon Page**: amazon.com/coupons ‚Äî clip before buying\n- **Price tracking**: CamelCamelCamel alerts when price drops\n\n**Best Times to Buy:**\n- **Prime Day** (July): Best on Amazon devices, electronics\n- **Black Friday/Cyber Monday**: Wide discounts\n- **January**: Post-holiday clearance`],
  [["coupon", "code", "promo", "discount", "voucher"], `**Finding the Best Coupon Codes**\n\n**Auto-Apply Extensions:**\n1. Honey (most popular, wide coverage)\n2. Capital One Shopping (also finds lower prices)\n3. Cently (works where Honey doesn't)\n\n**Manual Coupon Sites:**\n- RetailMeNot.com (largest database)\n- Coupons.com (grocery focused)\n- Slickdeals.net (community-verified deals)\n\n**Stacking Strategy:**\n1. Email signup discount (10-15%)\n2. + Coupon code (5-20%)\n3. + Cash back via Rakuten (1-15%)\n4. + Cash back credit card (2-5%)\n\n**= 15-35% total savings!**`],
  [["cashback", "cash back", "rakuten", "ibotta", "rebate"], `**Cash Back Guide ‚Äî Free Money**\n\n**Online Shopping:**\n1. **Rakuten** ‚Äî 2-15% back at 3500+ stores ($10 sign-up bonus)\n2. **TopCashback** ‚Äî Often higher rates than Rakuten\n3. **BeFrugal** ‚Äî Best rates on some stores\n4. **RetailMeNot** ‚Äî Coupons + cash back combo\n\n**Groceries:**\n1. **Ibotta** ‚Äî Scan receipts, avg $20-50/month back\n2. **Fetch Rewards** ‚Äî Points for any receipt\n3. **Checkout 51** ‚Äî Weekly grocery offers\n\n**Credit Cards (bonus layer):**\n- Chase Freedom Flex: 5% rotating categories\n- Citi Double Cash: 2% on everything\n- Capital One SavorOne: 3% dining + grocery\n\n**Pro Move:** Stack store coupon + Rakuten + cashback card = triple dip on every purchase.`],
  [["student", "college", "university", "edu"], `**Student Discounts You're Missing**\n\n**Tech:**\n- Apple: Education pricing ($100-200 off Macs)\n- Microsoft: Free Office 365\n- Adobe: Creative Cloud 60% off ($22/mo vs $55)\n- GitHub: Free Pro + $200 cloud credits\n- Amazon Prime: 50% off ($7.49/mo)\n\n**Shopping:**\n- Nike: 10% off\n- Adidas: 30% off\n- ASOS: 10% off\n- Samsung: Up to 30% off\n- Spotify + Hulu: $5.99/mo bundle\n\n**How to Verify:**\n- UNiDAYS (most brands)\n- SheerID (auto-verify .edu email)\n- Student Beans app\n\n**Even After Graduation:** Some discounts work up to 6 months post-grad. Stock up!`],
  [["subscription", "cancel", "recurring", "monthly", "annual", "membership"], `**Subscription Savings Guide**\n\n**Audit Your Subscriptions:**\n1. Check bank/card statements for recurring charges\n2. Use **Trim** or **Rocket Money** to find forgotten subs\n3. Average American wastes $133/month on unused subscriptions\n\n**Negotiation Scripts (actually work):**\n- "I'd like to cancel" ‚Üí most will offer 20-50% off to stay\n- "I found a better price at [competitor]" ‚Üí they'll price match\n- "Can I switch to annual billing?" ‚Üí usually 20-40% cheaper\n\n**Sharing is Saving:**\n- Netflix, Spotify, YouTube Premium, Apple One ‚Äî all have family plans\n- Split cost = 50-70% cheaper per person\n\n**Free Alternatives:**\n- Netflix ‚Üí Tubi, Pluto TV, Kanopy (free with library card)\n- Spotify ‚Üí YouTube Music (free tier), Spotify free\n- Audible ‚Üí Libby (free audiobooks from your library!)`],
  [["black friday", "cyber monday", "holiday", "christmas", "sale"], `**Black Friday / Cyber Monday Strategy**\n\n**What's Actually Cheap:**\n- TVs (30-50% off ‚Äî best deals of the year)\n- Amazon devices (Echo, Fire TV, Kindle ‚Äî 50% off)\n- Clothing (40-60% off at most retailers)\n- Toys (best prices of the year)\n\n**What's NOT Actually Cheaper:**\n- Apple products (small discounts, buy refurbished instead)\n- Furniture (Presidents Day sales are better)\n- Fitness equipment (wait for January New Year sales)\n\n**Strategy:**\n1. Make your list NOW ‚Äî don't impulse buy\n2. Set CamelCamelCamel price alerts\n3. Check prices BEFORE Black Friday (fake "discounts" are common)\n4. Stack: sale price + coupon code + Rakuten + cashback card\n5. Cyber Monday often has BETTER deals than Black Friday`]
];
}

// ============================================================
// SHARE & REFERRAL
// ============================================================
function shareOnX(preview) {
  const text = `${SHARE_TEXT}\n\nTry it free: https://${DOMAIN}?ref=${getRefCode()}\n\n@SpunkArt13`;
  window.open(`https://x.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
  if (typeof gtag === 'function') gtag('event', 'share_x', { bot: SLUG });
}

function copyResponse(btn) {
  const text = btn.closest('.msg-bot').querySelector('div').textContent;
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}

function getRefCode() {
  let code = localStorage.getItem('aibot_ref_code');
  if (!code) {
    code = SLUG + '_' + Math.random().toString(36).substring(2, 10);
    localStorage.setItem('aibot_ref_code', code);
  }
  return code;
}

function shareRef() {
  const url = `https://${DOMAIN}?ref=${getRefCode()}`;
  navigator.clipboard.writeText(url).then(() => alert('Referral link copied! Share it to earn 5 bonus uses.'));
}

// Check for referral on load
(function checkRef() {
  const params = new URLSearchParams(window.location.search);
  const ref = params.get('ref');
  if (ref && !localStorage.getItem('aibot_ref_used')) {
    const bonus = parseInt(localStorage.getItem('aibot_bonus') || '0');
    localStorage.setItem('aibot_bonus', bonus + REFERRAL_BONUS);
    localStorage.setItem('aibot_ref_used', ref);
    if (typeof gtag === 'function') gtag('event', 'referral_activated', { ref_code: ref, bot: SLUG });
  }
})();

// ============================================================
// PAYWALL
// ============================================================
let selectedPlan = 'month';

function showPaywall() {
  document.getElementById('paywallModal').classList.add('active');
  selectPlan('month');
}

function closePaywall() {
  document.getElementById('paywallModal').classList.remove('active');
}

function selectPlan(plan) {
  selectedPlan = plan;
  document.getElementById('planDay').style.borderColor = plan === 'day' ? 'var(--accent)' : 'var(--border)';
  document.getElementById('planMonth').style.borderColor = plan === 'month' ? 'var(--accent)' : 'var(--border)';
}

function payStripe() {
  // Placeholder ‚Äî integrate Stripe Checkout
  // window.location.href = `https://checkout.stripe.com/...?plan=${selectedPlan}`;
  alert('Stripe payments coming soon! For now, use crypto or contact @SpunkArt13 on X.');
}

function toggleCrypto() {
  document.getElementById('cryptoDetails').classList.toggle('active');
}

function copyAddr(el) {
  navigator.clipboard.writeText(el.textContent).then(() => {
    const orig = el.textContent;
    el.textContent = 'Copied!';
    setTimeout(() => el.textContent = orig, 2000);
  });
}

// ============================================================
// INIT
// ============================================================
updateUsageDisplay();

inputEl.addEventListener('keydown', e => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

// Referral tracking
const urlParams = new URLSearchParams(window.location.search);
const ref = urlParams.get('ref');
if (ref) {
  localStorage.setItem('aibot_ref', ref);
  if (typeof gtag === 'function') gtag('event', 'referral_visit', { referral_code: ref, source: SLUG });
}
</script>
</body>
</html>